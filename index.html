<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2487.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; -webkit-text-stroke: #000000}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #900112; -webkit-text-stroke: #900112}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #0e6e6d; -webkit-text-stroke: #0e6e6d}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #0000ff; -webkit-text-stroke: #0000ff}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; -webkit-text-stroke: #000000; min-height: 14.0px}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; -webkit-text-stroke: #000000; background-color: #fffffe}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Menlo; color: #0f7001; -webkit-text-stroke: #0f7001}
    span.s1 {font-kerning: none; color: #0000ff; background-color: #fffffe; -webkit-text-stroke: 0px #0000ff}
    span.s2 {font-kerning: none; background-color: #fffffe}
    span.s3 {font-kerning: none; color: #0e6e6d; background-color: #fffffe; -webkit-text-stroke: 0px #0e6e6d}
    span.s4 {font-kerning: none; color: #900112; background-color: #fffffe; -webkit-text-stroke: 0px #900112}
    span.s5 {font-kerning: none; color: #000000; background-color: #fffffe; -webkit-text-stroke: 0px #000000}
    span.s6 {font-kerning: none}
    span.s7 {font-kerning: none; color: #137646; background-color: #fffffe; -webkit-text-stroke: 0px #137646}
    span.s8 {font-kerning: none; color: #0e6e6d; -webkit-text-stroke: 0px #0e6e6d}
    span.s9 {font-kerning: none; color: #900112; -webkit-text-stroke: 0px #900112}
    span.s10 {font-kerning: none; color: #0000ff; -webkit-text-stroke: 0px #0000ff}
    span.s11 {font-kerning: none; color: #6b0001; background-color: #fffffe; -webkit-text-stroke: 0px #6b0001}
  </style>
</head>
<body>
<p class="p1"><span class="s1">import</span><span class="s2"> </span><span class="s3">React</span><span class="s2">, { useState, useEffect, useRef } </span><span class="s1">from</span><span class="s2"> </span><span class="s4">'react'</span><span class="s2">;</span></p>
<p class="p2"><span class="s1">import</span><span class="s5"> { </span><span class="s3">Header</span><span class="s5"> } </span><span class="s1">from</span><span class="s5"> </span><span class="s2">'../Header'</span><span class="s5">;</span></p>
<p class="p2"><span class="s1">import</span><span class="s5"> { </span><span class="s3">Card</span><span class="s5"> } </span><span class="s1">from</span><span class="s5"> </span><span class="s2">'../ui/Card'</span><span class="s5">;</span></p>
<p class="p3"><span class="s1">import</span><span class="s5"> { </span><span class="s2">Button</span><span class="s5">, </span><span class="s2">BackToHomeButton</span><span class="s5"> } </span><span class="s1">from</span><span class="s5"> </span><span class="s4">'../ui/Button'</span><span class="s5">;</span></p>
<p class="p2"><span class="s1">import</span><span class="s5"> { </span><span class="s3">Input</span><span class="s5"> } </span><span class="s1">from</span><span class="s5"> </span><span class="s2">'../ui/Input'</span><span class="s5">;</span></p>
<p class="p2"><span class="s1">import</span><span class="s5"> { </span><span class="s3">Select</span><span class="s5"> } </span><span class="s1">from</span><span class="s5"> </span><span class="s2">'../ui/Select'</span><span class="s5">;</span></p>
<p class="p4"><span class="s2">import</span><span class="s5"> {<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>generatePetNames,<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>generatePetPersonality,<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>generateQuickFireList,<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>translatePetName,<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>generatePetHoroscope,<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>getPetConsultantResponse</span></p>
<p class="p2"><span class="s5">} </span><span class="s1">from</span><span class="s5"> </span><span class="s2">'../../services/geminiService'</span><span class="s5">;</span></p>
<p class="p3"><span class="s1">import</span><span class="s5"> { </span><span class="s2">PET_TYPES</span><span class="s5">, </span><span class="s2">PET_GENDERS</span><span class="s5">, </span><span class="s2">NAME_STYLES</span><span class="s5"> } </span><span class="s1">from</span><span class="s5"> </span><span class="s4">'../../constants'</span><span class="s5">;</span></p>
<p class="p3"><span class="s1">import</span><span class="s5"> { </span><span class="s2">GeneratedName</span><span class="s5">, </span><span class="s2">PetInfo</span><span class="s5">, </span><span class="s2">PetPersonalityResult</span><span class="s5">, </span><span class="s2">PetKind</span><span class="s5">, </span><span class="s2">ChatMessage</span><span class="s5">, </span><span class="s2">PetGender</span><span class="s5">, </span><span class="s2">PetType</span><span class="s5">, </span><span class="s2">QuotaError</span><span class="s5"> } </span><span class="s1">from</span><span class="s5"> </span><span class="s4">'../../types'</span><span class="s5">;</span></p>
<p class="p2"><span class="s1">import</span><span class="s5"> { useLanguage } </span><span class="s1">from</span><span class="s5"> </span><span class="s2">'../../contexts/LanguageContext'</span><span class="s5">;</span></p>
<p class="p2"><span class="s1">import</span><span class="s5"> { </span><span class="s3">PetCharacter</span><span class="s5"> } </span><span class="s1">from</span><span class="s5"> </span><span class="s2">'../assets/pets/PetCharacter'</span><span class="s5">;</span></p>
<p class="p2"><span class="s1">import</span><span class="s5"> { </span><span class="s3">Modal</span><span class="s5"> } </span><span class="s1">from</span><span class="s5"> </span><span class="s2">'../ui/Modal'</span><span class="s5">;</span></p>
<p class="p5"><span class="s6"></span><br></p>
<p class="p2"><span class="s1">const</span><span class="s5"> </span><span class="s3">HEART_PATH</span><span class="s5"> = </span><span class="s2">"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"</span><span class="s5">;</span></p>
<p class="p3"><span class="s1">const</span><span class="s5"> </span><span class="s2">HeartIconFilled</span><span class="s5"> = (props: </span><span class="s2">React</span><span class="s5">.</span><span class="s2">SVGProps</span><span class="s5">&lt;</span><span class="s2">SVGSVGElement</span><span class="s5">&gt;) =&gt; (</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>&lt;svg xmlns=</span><span class="s4">"http://www.w3.org/2000/svg"</span><span class="s2"> viewBox=</span><span class="s4">"0 0 24 24"</span><span class="s2"> fill=</span><span class="s4">"currentColor"</span><span class="s2"> {...props}&gt;&lt;path d={</span><span class="s3">HEART_PATH</span><span class="s2">} /&gt;&lt;/svg&gt;</span></p>
<p class="p1"><span class="s2">);</span></p>
<p class="p3"><span class="s1">const</span><span class="s5"> </span><span class="s2">HeartIconOutline</span><span class="s5"> = (props: </span><span class="s2">React</span><span class="s5">.</span><span class="s2">SVGProps</span><span class="s5">&lt;</span><span class="s2">SVGSVGElement</span><span class="s5">&gt;) =&gt; (</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>&lt;svg xmlns=</span><span class="s4">"http://www.w3.org/2000/svg"</span><span class="s2"> fill=</span><span class="s4">"none"</span><span class="s2"> viewBox=</span><span class="s4">"0 0 24 24"</span><span class="s2"> strokeWidth={</span><span class="s7">1.5</span><span class="s2">} stroke=</span><span class="s4">"currentColor"</span><span class="s2"> {...props}&gt;&lt;path strokeLinecap=</span><span class="s4">"round"</span><span class="s2"> strokeLinejoin=</span><span class="s4">"round"</span><span class="s2"> d={</span><span class="s3">HEART_PATH</span><span class="s2">} /&gt;&lt;/svg&gt;</span></p>
<p class="p1"><span class="s2">);</span></p>
<p class="p5"><span class="s6"></span><br></p>
<p class="p3"><span class="s1">const</span><span class="s5"> </span><span class="s2">BackIcon</span><span class="s5"> = (props: </span><span class="s2">React</span><span class="s5">.</span><span class="s2">SVGProps</span><span class="s5">&lt;</span><span class="s2">SVGSVGElement</span><span class="s5">&gt;) =&gt; (</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>&lt;svg xmlns=</span><span class="s4">"http://www.w3.org/2000/svg"</span><span class="s2"> fill=</span><span class="s4">"none"</span><span class="s2"> viewBox=</span><span class="s4">"0 0 24 24"</span><span class="s2"> strokeWidth={</span><span class="s7">2.5</span><span class="s2">} stroke=</span><span class="s4">"currentColor"</span><span class="s2"> {...props}&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>&lt;path strokeLinecap=</span><span class="s4">"round"</span><span class="s2"> strokeLinejoin=</span><span class="s4">"round"</span><span class="s2"> d=</span><span class="s4">"M15.75 19.5 8.25 12l7.5-7.5"</span><span class="s2"> /&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>&lt;/svg&gt;</span></p>
<p class="p1"><span class="s2">);</span></p>
<p class="p5"><span class="s6"></span><br></p>
<p class="p3"><span class="s1">const</span><span class="s5"> </span><span class="s2">NameTranslator</span><span class="s5">: </span><span class="s2">React</span><span class="s5">.</span><span class="s2">FC</span><span class="s5"> = () =&gt; {</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> { t } = useLanguage();</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [petName, setPetName] = useState(</span><span class="s4">''</span><span class="s2">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [targetLang, setTargetLang] = useState(</span><span class="s4">"Japanese"</span><span class="s2">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [result, setResult] = useState&lt;{ translation: </span><span class="s1">string</span><span class="s2">; pronunciation: </span><span class="s1">string</span><span class="s2"> } | </span><span class="s1">null</span><span class="s2">&gt;(</span><span class="s1">null</span><span class="s2">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [isLoading, setIsLoading] = useState(</span><span class="s1">false</span><span class="s2">);</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s5"> languages = [</span><span class="s2">"Japanese"</span><span class="s5">, </span><span class="s2">"Chinese"</span><span class="s5">, </span><span class="s2">"Russian"</span><span class="s5">, </span><span class="s2">"Arabic"</span><span class="s5">, </span><span class="s2">"French"</span><span class="s5">, </span><span class="s2">"German"</span><span class="s5">, </span><span class="s2">"Italian"</span><span class="s5">, </span><span class="s2">"Korean"</span><span class="s5">, </span><span class="s2">"Greek"</span><span class="s5">, </span><span class="s2">"Hindi"</span><span class="s5">];</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> handleTranslate = </span><span class="s1">async</span><span class="s2"> (e: </span><span class="s3">React</span><span class="s2">.</span><span class="s3">FormEvent</span><span class="s2">) =&gt; { e.preventDefault(); </span><span class="s1">if</span><span class="s2"> (!petName.trim()) </span><span class="s1">return</span><span class="s2">; setIsLoading(</span><span class="s1">true</span><span class="s2">); </span><span class="s1">try</span><span class="s2"> { </span><span class="s1">const</span><span class="s2"> data = </span><span class="s1">await</span><span class="s2"> translatePetName(petName, targetLang); setResult(data); } </span><span class="s1">catch</span><span class="s2"> (err) { console.error(err); } </span><span class="s1">finally</span><span class="s2"> { setIsLoading(</span><span class="s1">false</span><span class="s2">); } };</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">return</span><span class="s2"> (</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>&lt;</span><span class="s3">Card</span><span class="s2"> className=</span><span class="s4">"animate-fade-in"</span><span class="s2">&gt;</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">            </span>&lt;div className=</span><span class="s2">"flex flex-col items-center text-center mb-6"</span><span class="s5">&gt;&lt;</span><span class="s3">PetCharacter</span><span class="s5"> pet=</span><span class="s2">"bird"</span><span class="s5"> className=</span><span class="s2">"w-32 h-32 mb-4 drop-shadow-md"</span><span class="s5"> /&gt;&lt;h2 className=</span><span class="s2">"text-3xl font-black text-[#5D4037]"</span><span class="s5">&gt;{t.translator.title}&lt;/h2&gt;&lt;p className=</span><span class="s2">"opacity-80 text-lg font-bold"</span><span class="s5">&gt;{t.translator.subtitle}&lt;/p&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>&lt;form onSubmit={handleTranslate} className=</span><span class="s4">"max-w-md mx-auto space-y-4"</span><span class="s2">&gt;&lt;</span><span class="s3">Input</span><span class="s2"> id=</span><span class="s4">"trans-name"</span><span class="s2"> label={t.translator.label_name} value={petName} onChange={e =&gt; setPetName(e.target.value)} placeholder=</span><span class="s4">"e.g. Luna"</span><span class="s2"> /&gt;&lt;</span><span class="s3">Select</span><span class="s2"> id=</span><span class="s4">"trans-lang"</span><span class="s2"> label={t.translator.label_lang} value={targetLang} onChange={e =&gt; setTargetLang(e.target.value)}&gt;{languages.map(lang =&gt; &lt;option key={lang} value={lang}&gt;{lang}&lt;/option&gt;)}&lt;/</span><span class="s3">Select</span><span class="s2">&gt;&lt;div className=</span><span class="s4">"flex justify-center pt-2"</span><span class="s2">&gt;&lt;</span><span class="s3">Button</span><span class="s2"> </span><span class="s1">type</span><span class="s2">=</span><span class="s4">"submit"</span><span class="s2"> disabled={isLoading || !petName.trim()}&gt;{isLoading ? t.translator.btn_translating : t.translator.btn_translate}&lt;/</span><span class="s3">Button</span><span class="s2">&gt;&lt;/div&gt;&lt;/form&gt;</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">            </span>{result &amp;&amp; !isLoading &amp;&amp; &lt;div className=</span><span class="s2">"mt-8 p-6 bg-white/40 rounded-2xl text-center animate-fade-in border border-white/40 shadow-inner"</span><span class="s5">&gt;&lt;p className=</span><span class="s2">"text-5xl font-black text-[#5D4037] mb-2"</span><span class="s5">&gt;{result.translation}&lt;/p&gt;&lt;p className=</span><span class="s2">"text-lg font-bold text-[#AA336A] italic"</span><span class="s5">&gt;{t.translator.pronunciation}: {result.pronunciation}&lt;/p&gt;&lt;/div&gt;}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>&lt;/</span><span class="s3">Card</span><span class="s2">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>);</span></p>
<p class="p1"><span class="s2">};</span></p>
<p class="p5"><span class="s6"></span><br></p>
<p class="p3"><span class="s1">const</span><span class="s5"> </span><span class="s2">PetHoroscope</span><span class="s5">: </span><span class="s2">React</span><span class="s5">.</span><span class="s2">FC</span><span class="s5"> = () =&gt; {</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> { t, language } = useLanguage();</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [petName, setPetName] = useState(</span><span class="s4">''</span><span class="s2">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [petType, setPetType] = useState&lt;</span><span class="s3">PetType</span><span class="s2">&gt;(</span><span class="s4">'Dog'</span><span class="s2">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [petGender, setPetGender] = useState&lt;</span><span class="s3">PetGender</span><span class="s2">&gt;(</span><span class="s4">'Any'</span><span class="s2">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [sign, setSign] = useState(</span><span class="s4">"Aries (Mar 21 - Apr 19)"</span><span class="s2">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [reading, setReading] = useState&lt;{ prediction: </span><span class="s1">string</span><span class="s2">; luckyItem: </span><span class="s1">string</span><span class="s2"> } | </span><span class="s1">null</span><span class="s2">&gt;(</span><span class="s1">null</span><span class="s2">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [isLoading, setIsLoading] = useState(</span><span class="s1">false</span><span class="s2">);</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s5"> signs = [</span><span class="s2">"Aries (Mar 21 - Apr 19)"</span><span class="s5">, </span><span class="s2">"Taurus (Apr 20 - May 20)"</span><span class="s5">, </span><span class="s2">"Gemini (May 21 - Jun 20)"</span><span class="s5">, </span><span class="s2">"Cancer (Jun 21 - Jul 22)"</span><span class="s5">, </span><span class="s2">"Leo (Jul 23 - Aug 22)"</span><span class="s5">, </span><span class="s2">"Virgo (Aug 23 - Sep 22)"</span><span class="s5">, </span><span class="s2">"Libra (Sep 23 - Oct 22)"</span><span class="s5">, </span><span class="s2">"Scorpio (Oct 23 - Nov 21)"</span><span class="s5">, </span><span class="s2">"Sagittarius (Nov 22 - Dec 21)"</span><span class="s5">, </span><span class="s2">"Capricorn (Dec 22 - Jan 19)"</span><span class="s5">, </span><span class="s2">"Aquarius (Jan 20 - Feb 18)"</span><span class="s5">, </span><span class="s2">"Pisces (Feb 19 - Mar 20)"</span><span class="s5">];</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> handleGetReading = </span><span class="s1">async</span><span class="s2"> () =&gt; { </span><span class="s1">if</span><span class="s2"> (!petName.trim()) </span><span class="s1">return</span><span class="s2">; setIsLoading(</span><span class="s1">true</span><span class="s2">); </span><span class="s1">try</span><span class="s2"> { </span><span class="s1">const</span><span class="s2"> res = </span><span class="s1">await</span><span class="s2"> generatePetHoroscope(sign, </span><span class="s4">`</span><span class="s2">${petGender}</span><span class="s4"> </span><span class="s2">${petType}</span><span class="s4">`</span><span class="s2">, petName, language); setReading(res); } </span><span class="s1">catch</span><span class="s2"> (err) { console.error(err); } </span><span class="s1">finally</span><span class="s2"> { setIsLoading(</span><span class="s1">false</span><span class="s2">); } };</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">return</span><span class="s2"> (</span></p>
<p class="p6"><span class="s6"><span class="Apple-converted-space">        </span>&lt;</span><span class="s8">Card</span><span class="s6">&gt;&lt;div className=</span><span class="s9">"text-center mb-6 flex flex-col items-center"</span><span class="s6">&gt;&lt;</span><span class="s8">PetCharacter</span><span class="s6"> pet=</span><span class="s9">"lizard"</span><span class="s6"> className=</span><span class="s9">"w-32 h-32 mb-4 drop-shadow-md"</span><span class="s6"> /&gt;&lt;h2 className=</span><span class="s9">"text-3xl font-black text-[#5D4037]"</span><span class="s6">&gt;{t.horoscope.title}&lt;/h2&gt;&lt;p className=</span><span class="s9">"opacity-80 text-lg font-bold"</span><span class="s6">&gt;{t.horoscope.subtitle}&lt;/p&gt;&lt;/div&gt;&lt;div className=</span><span class="s9">"max-w-md mx-auto space-y-4"</span><span class="s6">&gt;&lt;</span><span class="s8">Input</span><span class="s6"> id=</span><span class="s9">"horo-name"</span><span class="s6"> label={t.horoscope.label_name} value={petName} onChange={e =&gt; setPetName(e.target.value)} placeholder=</span><span class="s9">"e.g. Luna"</span><span class="s6"> /&gt;&lt;div className=</span><span class="s9">"grid grid-cols-2 gap-4"</span><span class="s6">&gt;&lt;</span><span class="s8">Select</span><span class="s6"> id=</span><span class="s9">"horo-type"</span><span class="s6"> label={t.generator.label_type} value={petType} onChange={e =&gt; setPetType(e.target.value </span><span class="s10">as</span><span class="s6"> </span><span class="s8">PetType</span><span class="s6">)}&gt;{</span><span class="s8">PET_TYPES</span><span class="s6">.map(</span><span class="s10">type</span><span class="s6"> =&gt; &lt;option key={</span><span class="s10">type</span><span class="s6">} value={</span><span class="s10">type</span><span class="s6">}&gt;{t.options.types[</span><span class="s10">type</span><span class="s6">] || </span><span class="s10">type</span><span class="s6">}&lt;/option&gt;)}&lt;/</span><span class="s8">Select</span><span class="s6">&gt;&lt;</span><span class="s8">Select</span><span class="s6"> id=</span><span class="s9">"horo-gender"</span><span class="s6"> label={t.generator.label_gender} value={petGender} onChange={e =&gt; setPetGender(e.target.value </span><span class="s10">as</span><span class="s6"> </span><span class="s8">PetGender</span><span class="s6">)}&gt;{</span><span class="s8">PET_GENDERS</span><span class="s6">.map(g =&gt; &lt;option key={g} value={g}&gt;{t.options.genders[g] || g}&lt;/option&gt;)}&lt;/</span><span class="s8">Select</span><span class="s6">&gt;&lt;/div&gt;&lt;</span><span class="s8">Select</span><span class="s6"> id=</span><span class="s9">"horo-sign"</span><span class="s6"> label={t.horoscope.label_zodiac} value={sign} onChange={e =&gt; setSign(e.target.value)}&gt;{signs.map(s =&gt; &lt;option key={s} value={s}&gt;{s}&lt;/option&gt;)}&lt;/</span><span class="s8">Select</span><span class="s6">&gt;&lt;div className=</span><span class="s9">"flex justify-center pt-2"</span><span class="s6">&gt;&lt;</span><span class="s8">Button</span><span class="s6"> onClick={handleGetReading} disabled={isLoading || !petName.trim()}&gt;{isLoading ? t.horoscope.btn_reading : t.horoscope.btn_read}&lt;/</span><span class="s8">Button</span><span class="s6">&gt;&lt;/div&gt;&lt;/div&gt;{reading &amp;&amp; &lt;div className=</span><span class="s9">"mt-8 p-6 bg-purple-500/10 rounded-2xl animate-fade-in border border-white/20"</span><span class="s6">&gt;&lt;h3 className=</span><span class="s9">"text-xl font-bold text-[#AA336A] mb-2"</span><span class="s6">&gt;{petName}: {t.horoscope.result_title}&lt;/h3&gt;&lt;p className=</span><span class="s9">"text-lg font-medium italic mb-4"</span><span class="s6">&gt;</span><span class="s9">"{reading.prediction}"</span><span class="s6">&lt;/p&gt;&lt;div className=</span><span class="s9">"bg-white/30 rounded-lg p-3 inline-block"</span><span class="s6">&gt;&lt;span className=</span><span class="s9">"text-xs uppercase tracking-widest opacity-70 font-bold block"</span><span class="s6">&gt;{t.horoscope.lucky_item}&lt;/span&gt;&lt;span className=</span><span class="s9">"font-bold text-[#5D4037]"</span><span class="s6">&gt;{reading.luckyItem}&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;}&lt;/</span><span class="s8">Card</span><span class="s6">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>);</span></p>
<p class="p1"><span class="s2">};</span></p>
<p class="p5"><span class="s6"></span><br></p>
<p class="p3"><span class="s1">const</span><span class="s5"> </span><span class="s2">PetAgeCalculator</span><span class="s5">: </span><span class="s2">React</span><span class="s5">.</span><span class="s2">FC</span><span class="s5"> = () =&gt; {</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> { t } = useLanguage();</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [age, setAge] = useState(</span><span class="s4">''</span><span class="s2">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [humanAge, setHumanAge] = useState&lt;</span><span class="s1">number</span><span class="s2"> | </span><span class="s1">null</span><span class="s2">&gt;(</span><span class="s1">null</span><span class="s2">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> calculate = () =&gt; { </span><span class="s1">const</span><span class="s2"> years = parseFloat(age); </span><span class="s1">if</span><span class="s2"> (!isNaN(years)) setHumanAge(</span><span class="s3">Math</span><span class="s2">.floor(years * </span><span class="s7">7</span><span class="s2">)); };</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">return</span><span class="s2"> (</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>&lt;</span><span class="s3">Card</span><span class="s2">&gt;&lt;div className=</span><span class="s4">"text-center mb-6 flex flex-col items-center"</span><span class="s2">&gt;&lt;</span><span class="s3">PetCharacter</span><span class="s2"> pet=</span><span class="s4">"rabbit"</span><span class="s2"> className=</span><span class="s4">"w-32 h-32 mb-4 drop-shadow-md"</span><span class="s2"> /&gt;&lt;h2 className=</span><span class="s4">"text-3xl font-black text-[#5D4037]"</span><span class="s2">&gt;{t.age_calc.title}&lt;/h2&gt;&lt;p className=</span><span class="s4">"opacity-80 text-lg font-bold"</span><span class="s2">&gt;{t.age_calc.subtitle}&lt;/p&gt;&lt;/div&gt;&lt;div className=</span><span class="s4">"max-w-md mx-auto space-y-4"</span><span class="s2">&gt;&lt;</span><span class="s3">Input</span><span class="s2"> id=</span><span class="s4">"age-input"</span><span class="s2"> label={t.age_calc.label_age} </span><span class="s1">type</span><span class="s2">=</span><span class="s4">"number"</span><span class="s2"> value={age} onChange={e =&gt; setAge(e.target.value)} placeholder=</span><span class="s4">"e.g. 2"</span><span class="s2"> /&gt;&lt;div className=</span><span class="s4">"flex justify-center pt-2"</span><span class="s2">&gt;&lt;</span><span class="s3">Button</span><span class="s2"> onClick={calculate}&gt;{t.age_calc.btn_calculate}&lt;/</span><span class="s3">Button</span><span class="s2">&gt;&lt;/div&gt;&lt;/div&gt;{humanAge !== </span><span class="s1">null</span><span class="s2"> &amp;&amp; &lt;div className=</span><span class="s4">"mt-8 text-center animate-fade-in bg-white/30 p-6 rounded-2xl border border-white/40"</span><span class="s2">&gt;&lt;p className=</span><span class="s4">"text-lg font-bold opacity-80 mb-1"</span><span class="s2">&gt;{t.age_calc.result_prefix}&lt;/p&gt;&lt;p className=</span><span class="s4">"text-6xl font-black text-[#AA336A]"</span><span class="s2">&gt;{humanAge}&lt;/p&gt;&lt;p className=</span><span class="s4">"text-sm font-bold uppercase tracking-wider mt-2 opacity-60"</span><span class="s2">&gt;{t.age_calc.result_suffix}&lt;/p&gt;&lt;/div&gt;}&lt;/</span><span class="s3">Card</span><span class="s2">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>);</span></p>
<p class="p1"><span class="s2">};</span></p>
<p class="p5"><span class="s6"></span><br></p>
<p class="p1"><span class="s1">const</span><span class="s2"> </span><span class="s3">PersonalityQuiz</span><span class="s2">: </span><span class="s3">React</span><span class="s2">.</span><span class="s3">FC</span><span class="s2">&lt;{ onQuizComplete: (res: </span><span class="s3">PetPersonalityResult</span><span class="s2">) =&gt; </span><span class="s1">void</span><span class="s2">, petInfo: </span><span class="s3">PetInfo</span><span class="s2">, setPetInfo: (info: </span><span class="s1">any</span><span class="s2">) =&gt; </span><span class="s1">void</span><span class="s2">, addSavedName: (n: </span><span class="s3">GeneratedName</span><span class="s2">) =&gt; </span><span class="s1">void</span><span class="s2">, savedNames: </span><span class="s3">GeneratedName</span><span class="s2">[] }&gt; = ({ onQuizComplete, petInfo, setPetInfo, addSavedName, savedNames }) =&gt; {</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> { t, language } = useLanguage();</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [step, setStep] = useState(</span><span class="s7">0</span><span class="s2">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [answers, setAnswers] = useState&lt;</span><span class="s1">string</span><span class="s2">[]&gt;([]);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [isLoading, setIsLoading] = useState(</span><span class="s1">false</span><span class="s2">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [result, setResult] = useState&lt;</span><span class="s3">PetPersonalityResult</span><span class="s2"> | </span><span class="s1">null</span><span class="s2">&gt;(</span><span class="s1">null</span><span class="s2">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [names, setNames] = useState&lt;</span><span class="s3">GeneratedName</span><span class="s2">[]&gt;([]);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> questions = [{ q: t.quiz.q1, a: [{t: t.quiz.a1_1, v: </span><span class="s4">"Playful"</span><span class="s2">}, {t: t.quiz.a1_2, v: </span><span class="s4">"Calm"</span><span class="s2">}, {t: t.quiz.a1_3, v: </span><span class="s4">"Mischievous"</span><span class="s2">}] }, { q: t.quiz.q2, a: [{t: t.quiz.a2_1, v: </span><span class="s4">"Shy"</span><span class="s2">}, {t: t.quiz.a2_2, v: </span><span class="s4">"Outgoing"</span><span class="s2">}, {t: t.quiz.a2_3, v: </span><span class="s4">"Elegant"</span><span class="s2">}] }, { q: t.quiz.q3, a: [{t: t.quiz.a3_1, v: </span><span class="s4">"Chaotic"</span><span class="s2">}, {t: t.quiz.a3_2, v: </span><span class="s4">"Goofy"</span><span class="s2">}, {t: t.quiz.a3_3, v: </span><span class="s4">"Brave"</span><span class="s2">}] }];</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> handleAnswer = </span><span class="s1">async</span><span class="s2"> (val: </span><span class="s1">string</span><span class="s2">) =&gt; { </span><span class="s1">const</span><span class="s2"> newAns = [...answers, val]; setAnswers(newAns); </span><span class="s1">if</span><span class="s2"> (step &lt; questions.length - </span><span class="s7">1</span><span class="s2">) setStep(step + </span><span class="s7">1</span><span class="s2">); </span><span class="s1">else</span><span class="s2"> { setIsLoading(</span><span class="s1">true</span><span class="s2">); </span><span class="s1">try</span><span class="s2"> { </span><span class="s1">const</span><span class="s2"> res = </span><span class="s1">await</span><span class="s2"> generatePetPersonality(newAns, language); setResult(res); onQuizComplete(res); </span><span class="s1">const</span><span class="s2"> suggested = </span><span class="s1">await</span><span class="s2"> generatePetNames({...petInfo, personality: res.keywords.personality, style: res.keywords.style}, language); setNames(suggested.slice(</span><span class="s7">0</span><span class="s2">, </span><span class="s7">6</span><span class="s2">)); } </span><span class="s1">catch</span><span class="s2"> (err) { console.error(err); } </span><span class="s1">finally</span><span class="s2"> { setIsLoading(</span><span class="s1">false</span><span class="s2">); } } };</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">    </span></span><span class="s1">if</span><span class="s5"> (isLoading) </span><span class="s1">return</span><span class="s5"> &lt;</span><span class="s3">Card</span><span class="s5"> className=</span><span class="s2">"flex flex-col items-center py-20"</span><span class="s5">&gt;&lt;div className=</span><span class="s2">"animate-spin rounded-full h-12 w-12 border-b-2 border-[#AA336A] mb-4"</span><span class="s5">&gt;&lt;/div&gt;&lt;p className=</span><span class="s2">"text-xl font-bold"</span><span class="s5">&gt;{t.quiz.loading}&lt;/p&gt;&lt;/</span><span class="s3">Card</span><span class="s5">&gt;;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">if</span><span class="s2"> (result) </span><span class="s1">return</span><span class="s2"> (&lt;</span><span class="s3">Card</span><span class="s2"> className=</span><span class="s4">"text-center"</span><span class="s2">&gt;&lt;h3 className=</span><span class="s4">"text-xl font-bold mb-2"</span><span class="s2">&gt;{t.quiz.result_title}&lt;/h3&gt;&lt;p className=</span><span class="s4">"text-4xl font-black text-[#AA336A] mb-2"</span><span class="s2">&gt;{result.title}&lt;/p&gt;&lt;p className=</span><span class="s4">"italic mb-8 opacity-80 text-xl"</span><span class="s2">&gt;</span><span class="s4">"{result.description}"</span><span class="s2">&lt;/p&gt;&lt;div className=</span><span class="s4">"grid grid-cols-2 gap-3 mb-8"</span><span class="s2">&gt;{names.map(n =&gt; &lt;div key={n.id} className=</span><span class="s4">"bg-white/20 p-3 rounded-xl flex justify-between items-center"</span><span class="s2">&gt;&lt;span className=</span><span class="s4">"font-bold"</span><span class="s2">&gt;{n.name}&lt;/span&gt;&lt;button onClick={() =&gt; addSavedName(n)} className=</span><span class="s4">"text-[#AA336A] p-1"</span><span class="s2">&gt;{savedNames.some(s =&gt; s.id === n.id) ? &lt;</span><span class="s3">HeartIconFilled</span><span class="s2"> className=</span><span class="s4">"w-6 h-6"</span><span class="s2"> /&gt; : &lt;</span><span class="s3">HeartIconOutline</span><span class="s2"> className=</span><span class="s4">"w-6 h-6"</span><span class="s2"> /&gt;}&lt;/button&gt;&lt;/div&gt;)}&lt;/div&gt;&lt;</span><span class="s3">Button</span><span class="s2"> onClick={() =&gt; { setStep(</span><span class="s7">0</span><span class="s2">); setAnswers([]); setResult(</span><span class="s1">null</span><span class="s2">); }} variant=</span><span class="s4">"secondary"</span><span class="s2">&gt;{t.quiz.play_again}&lt;/</span><span class="s3">Button</span><span class="s2">&gt;&lt;/</span><span class="s3">Card</span><span class="s2">&gt;);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> current = questions[step];</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">return</span><span class="s2"> (&lt;</span><span class="s3">Card</span><span class="s2">&gt;&lt;div className=</span><span class="s4">"text-center mb-8"</span><span class="s2">&gt;&lt;</span><span class="s3">PetCharacter</span><span class="s2"> pet=</span><span class="s4">"hamster"</span><span class="s2"> className=</span><span class="s4">"w-32 h-32 mx-auto mb-4"</span><span class="s2"> /&gt;&lt;h2 className=</span><span class="s4">"text-3xl font-black"</span><span class="s2">&gt;{t.quiz.title}&lt;/h2&gt;&lt;div className=</span><span class="s4">"w-full bg-white/20 h-2 rounded-full mt-4 overflow-hidden shadow-inner"</span><span class="s2">&gt;&lt;div className=</span><span class="s4">"bg-[#AA336A] h-full transition-all duration-300"</span><span class="s2"> style={{ width: </span><span class="s4">`</span><span class="s2">${(step/questions.length)*</span><span class="s7">100</span><span class="s2">}</span><span class="s4">%`</span><span class="s2"> }}&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;p className=</span><span class="s4">"text-xl font-bold text-center mb-6"</span><span class="s2">&gt;{current.q}&lt;/p&gt;&lt;div className=</span><span class="s4">"space-y-3 max-w-md mx-auto"</span><span class="s2">&gt;{current.a.map((a, i) =&gt; &lt;</span><span class="s3">Button</span><span class="s2"> key={i} onClick={() =&gt; handleAnswer(a.v)} variant=</span><span class="s4">"secondary"</span><span class="s2"> className=</span><span class="s4">"!w-full !justify-start !text-left"</span><span class="s2">&gt;{a.t}&lt;/</span><span class="s3">Button</span><span class="s2">&gt;)}&lt;/div&gt;&lt;/</span><span class="s3">Card</span><span class="s2">&gt;);</span></p>
<p class="p1"><span class="s2">};</span></p>
<p class="p5"><span class="s6"></span><br></p>
<p class="p1"><span class="s1">const</span><span class="s2"> </span><span class="s3">QuickFireDiscovery</span><span class="s2">: </span><span class="s3">React</span><span class="s2">.</span><span class="s3">FC</span><span class="s2">&lt;{ addSavedName: (n: </span><span class="s3">GeneratedName</span><span class="s2">) =&gt; </span><span class="s1">void</span><span class="s2">, savedNames: </span><span class="s3">GeneratedName</span><span class="s2">[], petInfo: </span><span class="s3">PetInfo</span><span class="s2">, setPetInfo: (info: </span><span class="s1">any</span><span class="s2">) =&gt; </span><span class="s1">void</span><span class="s2"> }&gt; = ({ addSavedName, savedNames, petInfo, setPetInfo }) =&gt; {</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> { t, language } = useLanguage();</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [state, setState] = useState&lt;</span><span class="s4">'idle'</span><span class="s2">|</span><span class="s4">'playing'</span><span class="s2">|</span><span class="s4">'results'</span><span class="s2">&gt;(</span><span class="s4">'idle'</span><span class="s2">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [pool, setPool] = useState&lt;</span><span class="s1">string</span><span class="s2">[]&gt;([]);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [round, setRound] = useState(</span><span class="s7">0</span><span class="s2">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [winners, setWinners] = useState&lt;</span><span class="s1">string</span><span class="s2">[]&gt;([]);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [isLoading, setIsLoading] = useState(</span><span class="s1">false</span><span class="s2">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> start = </span><span class="s1">async</span><span class="s2"> () =&gt; { setIsLoading(</span><span class="s1">true</span><span class="s2">); </span><span class="s1">try</span><span class="s2"> { </span><span class="s1">const</span><span class="s2"> list = </span><span class="s1">await</span><span class="s2"> generateQuickFireList(petInfo.style, petInfo.</span><span class="s1">type</span><span class="s2">, petInfo.gender, language); setPool(list); setWinners([]); setRound(</span><span class="s7">1</span><span class="s2">); setState(</span><span class="s4">'playing'</span><span class="s2">); } </span><span class="s1">catch</span><span class="s2"> (err) { console.error(err); } </span><span class="s1">finally</span><span class="s2"> { setIsLoading(</span><span class="s1">false</span><span class="s2">); } };</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> vote = (name: </span><span class="s1">string</span><span class="s2">) =&gt; { </span><span class="s1">const</span><span class="s2"> nextWinners = [...winners, name]; setWinners(nextWinners); </span><span class="s1">if</span><span class="s2"> (round &lt; </span><span class="s7">10</span><span class="s2">) setRound(round + </span><span class="s7">1</span><span class="s2">); </span><span class="s1">else</span><span class="s2"> setState(</span><span class="s4">'results'</span><span class="s2">); };</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> handleSaveSingleName = (name: </span><span class="s1">string</span><span class="s2">) =&gt; { </span><span class="s1">const</span><span class="s2"> isAlreadySaved = savedNames.some(s =&gt; s.name === name); </span><span class="s1">if</span><span class="s2"> (isAlreadySaved) </span><span class="s1">return</span><span class="s2">; </span><span class="s1">const</span><span class="s2"> generatedName: </span><span class="s3">GeneratedName</span><span class="s2"> = { id: </span><span class="s4">`</span><span class="s2">${</span><span class="s3">Date</span><span class="s2">.now()}</span><span class="s4">-</span><span class="s2">${name}</span><span class="s4">-</span><span class="s2">${</span><span class="s3">Math</span><span class="s2">.random()}</span><span class="s4">`</span><span class="s2">, name: name, meaning: </span><span class="s4">`</span><span class="s2">${t.quick_fire.generated_meaning_prefix}</span><span class="s4"> </span><span class="s2">${t.options.styles[petInfo.style] || petInfo.style}</span><span class="s4"> </span><span class="s2">${t.quick_fire.generated_meaning_suffix}</span><span class="s4">`</span><span class="s2">, style: petInfo.style }; addSavedName(generatedName); };</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">if</span><span class="s2"> (state === </span><span class="s4">'idle'</span><span class="s2">) </span><span class="s1">return</span><span class="s2"> (&lt;</span><span class="s3">Card</span><span class="s2"> className=</span><span class="s4">"text-center"</span><span class="s2">&gt;&lt;</span><span class="s3">PetCharacter</span><span class="s2"> pet=</span><span class="s4">"cat"</span><span class="s2"> className=</span><span class="s4">"w-32 h-32 mx-auto mb-4"</span><span class="s2"> /&gt;&lt;h2 className=</span><span class="s4">"text-3xl font-black mb-2"</span><span class="s2">&gt;{t.quick_fire.title}&lt;/h2&gt;&lt;p className=</span><span class="s4">"mb-8 opacity-80 text-lg font-bold"</span><span class="s2">&gt;{t.quick_fire.subtitle}&lt;/p&gt;&lt;div className=</span><span class="s4">"max-w-xs mx-auto space-y-4 mb-6"</span><span class="s2">&gt;&lt;</span><span class="s3">Select</span><span class="s2"> id=</span><span class="s4">"qf-style"</span><span class="s2"> label={t.generator.label_style} value={petInfo.style} onChange={e =&gt; setPetInfo({...petInfo, style: e.target.value})}&gt;{</span><span class="s3">NAME_STYLES</span><span class="s2">.map(s =&gt; &lt;option key={s} value={s}&gt;{t.options.styles[s] || s}&lt;/option&gt;)}&lt;/</span><span class="s3">Select</span><span class="s2">&gt;&lt;/div&gt;&lt;</span><span class="s3">Button</span><span class="s2"> onClick={start} disabled={isLoading}&gt;{isLoading ? t.quick_fire.btn_preparing : t.quick_fire.btn_start}&lt;/</span><span class="s3">Button</span><span class="s2">&gt;&lt;/</span><span class="s3">Card</span><span class="s2">&gt;);</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">    </span></span><span class="s1">if</span><span class="s5"> (state === </span><span class="s2">'playing'</span><span class="s5">) { </span><span class="s1">const</span><span class="s5"> p1 = pool[(round - </span><span class="s7">1</span><span class="s5">) * </span><span class="s7">2</span><span class="s5">]; </span><span class="s1">const</span><span class="s5"> p2 = pool[(round - </span><span class="s7">1</span><span class="s5">) * </span><span class="s7">2</span><span class="s5"> + </span><span class="s7">1</span><span class="s5">]; </span><span class="s1">return</span><span class="s5"> (&lt;</span><span class="s3">Card</span><span class="s5"> className=</span><span class="s2">"text-center"</span><span class="s5">&gt;&lt;div className=</span><span class="s2">"flex justify-between items-center mb-8 px-4"</span><span class="s5">&gt;&lt;span className=</span><span class="s2">"font-bold text-[#666666] opacity-60 uppercase tracking-widest text-sm"</span><span class="s5">&gt;{t.quick_fire.mode}&lt;/span&gt;&lt;span className=</span><span class="s2">"bg-[#AA336A] text-white px-3 py-1 rounded-full text-sm font-bold"</span><span class="s5">&gt;{round}/</span><span class="s7">10</span><span class="s5">&lt;/span&gt;&lt;/div&gt;&lt;div className=</span><span class="s2">"grid grid-cols-1 md:grid-cols-2 gap-4"</span><span class="s5">&gt;&lt;button onClick={() =&gt; vote(p1)} className=</span><span class="s2">"h-32 bg-gradient-to-br from-[#aab2a1] to-[#8da38d] rounded-2xl text-2xl font-black text-white shadow-lg hover:scale-105 transition-transform"</span><span class="s5">&gt;{p1}&lt;/button&gt;&lt;button onClick={() =&gt; vote(p2)} className=</span><span class="s2">"h-32 bg-gradient-to-bl from-[#e889b5] to-[#ffc4d6] rounded-2xl text-2xl font-black text-white shadow-lg hover:scale-105 transition-transform"</span><span class="s5">&gt;{p2}&lt;/button&gt;&lt;/div&gt;&lt;/</span><span class="s3">Card</span><span class="s5">&gt;); }</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">return</span><span class="s2"> (&lt;</span><span class="s3">Card</span><span class="s2"> className=</span><span class="s4">"text-center"</span><span class="s2">&gt;&lt;h3 className=</span><span class="s4">"text-3xl font-black text-[#AA336A] mb-4"</span><span class="s2">&gt;{t.quick_fire.winner_title}&lt;/h3&gt;&lt;div className=</span><span class="s4">"grid grid-cols-2 gap-2 mb-8 max-w-md mx-auto"</span><span class="s2">&gt;{winners.map((w, i) =&gt; &lt;div key={i} className=</span><span class="s4">"bg-white/20 p-2 rounded-lg font-bold flex justify-between items-center"</span><span class="s2">&gt;&lt;span&gt;{w}&lt;/span&gt;&lt;button onClick={() =&gt; handleSaveSingleName(w)} className=</span><span class="s4">"text-[#AA336A]"</span><span class="s2">&gt;{savedNames.some(s =&gt; s.name === w) ? &lt;</span><span class="s3">HeartIconFilled</span><span class="s2"> className=</span><span class="s4">"w-5 h-5"</span><span class="s2"> /&gt; : &lt;</span><span class="s3">HeartIconOutline</span><span class="s2"> className=</span><span class="s4">"w-5 h-5"</span><span class="s2"> /&gt;}&lt;/button&gt;&lt;/div&gt;)}&lt;/div&gt;&lt;</span><span class="s3">Button</span><span class="s2"> onClick={() =&gt; setState(</span><span class="s4">'idle'</span><span class="s2">)} variant=</span><span class="s4">"secondary"</span><span class="s2">&gt;{t.quick_fire.btn_play_again}&lt;/</span><span class="s3">Button</span><span class="s2">&gt;&lt;/</span><span class="s3">Card</span><span class="s2">&gt;);</span></p>
<p class="p1"><span class="s2">};</span></p>
<p class="p5"><span class="s6"></span><br></p>
<p class="p3"><span class="s1">interface</span><span class="s5"> </span><span class="s2">ExtendedChatMessage</span><span class="s5"> </span><span class="s1">extends</span><span class="s5"> </span><span class="s2">ChatMessage</span><span class="s5"> {</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>sources?: { uri: </span><span class="s1">string</span><span class="s2">; title: </span><span class="s1">string</span><span class="s2"> }[];</span></p>
<p class="p1"><span class="s2">}</span></p>
<p class="p5"><span class="s6"></span><br></p>
<p class="p3"><span class="s1">const</span><span class="s5"> </span><span class="s2">Consultant</span><span class="s5">: </span><span class="s2">React</span><span class="s5">.</span><span class="s2">FC</span><span class="s5"> = () =&gt; {</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> { t, language } = useLanguage();</span></p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">    </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [messages, setMessages] = useState&lt;</span><span class="s3">ExtendedChatMessage</span><span class="s2">[]&gt;(() =&gt; {</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">try</span><span class="s2"> {</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s1">const</span><span class="s2"> saved = localStorage.getItem(</span><span class="s4">'pet_chat_history'</span><span class="s2">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s1">if</span><span class="s2"> (saved) {</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s1">const</span><span class="s2"> parsed = </span><span class="s3">JSON</span><span class="s2">.parse(saved);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s1">return</span><span class="s2"> </span><span class="s3">Array</span><span class="s2">.isArray(parsed) ? parsed : [];</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>} </span><span class="s1">catch</span><span class="s2"> (e) { console.error(</span><span class="s4">"Consultant load error"</span><span class="s2">, e); }</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">return</span><span class="s2"> [];</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p5"><span class="s6"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [inputValue, setInputValue] = useState(</span><span class="s4">''</span><span class="s2">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [isTyping, setIsTyping] = useState(</span><span class="s1">false</span><span class="s2">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> [quotaModal, setQuotaModal] = useState&lt;{ isOpen: </span><span class="s1">boolean</span><span class="s2">; title: </span><span class="s1">string</span><span class="s2">; desc: </span><span class="s1">string</span><span class="s2"> }&gt;({</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>isOpen: </span><span class="s1">false</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>title: </span><span class="s4">''</span><span class="s2">,</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>desc: </span><span class="s4">''</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p5"><span class="s6"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> messagesEndRef = useRef&lt;</span><span class="s3">HTMLDivElement</span><span class="s2">&gt;(</span><span class="s1">null</span><span class="s2">);</span></p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">    </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>useEffect(() =&gt; {<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>localStorage.setItem(</span><span class="s4">'pet_chat_history'</span><span class="s2">, </span><span class="s3">JSON</span><span class="s2">.stringify(messages));</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">if</span><span class="s2"> (messages.length &gt; </span><span class="s7">0</span><span class="s2">) {</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>messagesEndRef.current?.scrollIntoView({ behavior: </span><span class="s4">'smooth'</span><span class="s2"> });<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>}, [messages]);</span></p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">    </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> cleanMessageText = (text: </span><span class="s1">any</span><span class="s2">) =&gt; {</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">if</span><span class="s2"> (!text || </span><span class="s1">typeof</span><span class="s2"> text !== </span><span class="s4">'string'</span><span class="s2">) </span><span class="s1">return</span><span class="s2"> </span><span class="s4">""</span><span class="s2">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">let</span><span class="s2"> clean = text;</span></p>
<p class="p7"><span class="s5"><span class="Apple-converted-space">        </span></span><span class="s2">// Basic cleaning of common markdown from LLM output</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>clean = clean.replace(</span><span class="s11">/\[([^\]]+)\]\([^\)]+\)/</span><span class="s1">g</span><span class="s2">, </span><span class="s4">'$1'</span><span class="s2">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>clean = clean.replace(</span><span class="s11">/\[([^\]]+)\]/</span><span class="s1">g</span><span class="s2">, </span><span class="s4">'$1'</span><span class="s2">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>clean = clean.replace(</span><span class="s11">/(https?:\/\/[^\s]+)/</span><span class="s1">g</span><span class="s2">, </span><span class="s4">''</span><span class="s2">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>clean = clean.replace(</span><span class="s11">/[*()\s]+$/</span><span class="s2">, </span><span class="s4">''</span><span class="s2">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">return</span><span class="s2"> clean.trim() || text;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>};</span></p>
<p class="p5"><span class="s6"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> handleSendMessage = </span><span class="s1">async</span><span class="s2"> (e?: </span><span class="s3">React</span><span class="s2">.</span><span class="s3">FormEvent</span><span class="s2">) =&gt; {<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">if</span><span class="s2"> (e) e.preventDefault();<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">if</span><span class="s2"> (!inputValue.trim() || isTyping) </span><span class="s1">return</span><span class="s2">;<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">const</span><span class="s2"> userMsg: </span><span class="s3">ExtendedChatMessage</span><span class="s2"> = { role: </span><span class="s4">'user'</span><span class="s2">, text: inputValue, timestamp: </span><span class="s3">Date</span><span class="s2">.now() };<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>setMessages(prev =&gt; [...prev, userMsg]);<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>setInputValue(</span><span class="s4">''</span><span class="s2">);<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>setIsTyping(</span><span class="s1">true</span><span class="s2">);<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">try</span><span class="s2"> {<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s1">const</span><span class="s2"> resp = </span><span class="s1">await</span><span class="s2"> getPetConsultantResponse([...messages, userMsg], inputValue, language, t.expert.system_instruction);<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>setMessages(prev =&gt; [...prev, { role: </span><span class="s4">'model'</span><span class="s2">, text: resp.text, sources: resp.sources, timestamp: </span><span class="s3">Date</span><span class="s2">.now() }]);<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>} </span><span class="s1">catch</span><span class="s2"> (error: </span><span class="s1">any</span><span class="s2">) {<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>console.error(error);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s1">if</span><span class="s2"> (error </span><span class="s1">instanceof</span><span class="s2"> </span><span class="s3">QuotaError</span><span class="s2">) {</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s1">const</span><span class="s2"> mapping = {</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s4">'LIMIT_REACHED'</span><span class="s2">: { title: t.quota.limit_reached_title, desc: t.quota.limit_reached_desc },</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s4">'GLOBAL_CAP_REACHED'</span><span class="s2">: { title: t.quota.global_cap_title, desc: t.quota.global_cap_desc },</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s4">'BUSY'</span><span class="s2">: { title: t.quota.busy_title, desc: t.quota.busy_desc },</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s4">'RATE_LIMITED'</span><span class="s2">: { title: t.quota.rate_limit_title, desc: t.quota.rate_limit_desc }</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span>};</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span>setQuotaModal({ isOpen: </span><span class="s1">true</span><span class="s2">, ...mapping[error.code] });</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>} </span><span class="s1">finally</span><span class="s2"> { setIsTyping(</span><span class="s1">false</span><span class="s2">); }<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>};</span></p>
<p class="p5"><span class="s6"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> handleClearChat = (e: </span><span class="s3">React</span><span class="s2">.</span><span class="s3">MouseEvent</span><span class="s2">) =&gt; {</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>e.preventDefault();</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>e.stopPropagation();</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">if</span><span class="s2"> (window.confirm(t.expert.clear_confirm || </span><span class="s4">"Clear chat history?"</span><span class="s2">)) {</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>setMessages([]);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>};</span></p>
<p class="p5"><span class="s6"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">return</span><span class="s2"> (</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>&lt;&gt;</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">            </span>&lt;</span><span class="s3">Card</span><span class="s5"> className=</span><span class="s2">"flex flex-col h-[650px] max-w-full overflow-hidden shadow-2xl border-2 border-white/50"</span><span class="s5">&gt;</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">                </span>&lt;div className=</span><span class="s2">"flex items-center justify-between border-b border-black/10 pb-4 mb-4 shrink-0"</span><span class="s5">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span>&lt;div className=</span><span class="s4">"flex items-center gap-3"</span><span class="s2">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span>&lt;</span><span class="s3">PetCharacter</span><span class="s2"> pet=</span><span class="s4">"dog"</span><span class="s2"> className=</span><span class="s4">"w-12 h-12"</span><span class="s2"> /&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span>&lt;h2 className=</span><span class="s4">"text-xl font-bold"</span><span class="s2">&gt;{t.expert.title}&lt;/h2&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span>&lt;button<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s1">type</span><span class="s2">=</span><span class="s4">"button"</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span>onClick={handleClearChat}<span class="Apple-converted-space"> </span></span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">                        </span>className=</span><span class="s2">"bg-red-500/10 hover:bg-red-500/20 px-4 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest text-red-600 transition-all active:scale-95 border border-red-500/20"</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span>&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span>{t.expert.btn_clear}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">                </span>&lt;div className=</span><span class="s2">"flex-grow overflow-y-auto pr-2 custom-scrollbar space-y-6"</span><span class="s5">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span>{messages.length === </span><span class="s7">0</span><span class="s2"> &amp;&amp; &lt;p className=</span><span class="s4">"text-center opacity-60 p-8 font-medium italic"</span><span class="s2">&gt;{t.expert.welcome}&lt;/p&gt;}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span>{messages.map((m, i) =&gt; (</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span>&lt;div key={i} className={</span><span class="s4">`flex </span><span class="s2">${m.role === </span><span class="s4">'user'</span><span class="s2"> ? </span><span class="s4">'justify-end'</span><span class="s2"> : </span><span class="s4">'justify-start'</span><span class="s2">}</span><span class="s4"> animate-fade-in`</span><span class="s2">}&gt;</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">                            </span>&lt;div className={</span><span class="s2">`max-w-[85%] p-5 rounded-2xl text-xl leading-relaxed shadow-sm </span><span class="s5">${m.role === </span><span class="s2">'user'</span><span class="s5"> ? </span><span class="s2">'bg-[#AA336A] text-white rounded-tr-none'</span><span class="s5"> : </span><span class="s2">'bg-white/80 border border-white/40 rounded-tl-none text-[#333333]'</span><span class="s5">}</span><span class="s2">`</span><span class="s5">}&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span>&lt;div className=</span><span class="s4">"whitespace-pre-wrap"</span><span class="s2">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                    </span>{m.role === </span><span class="s4">'user'</span><span class="s2"> ? m.text : cleanMessageText(m.text)}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s2"><span class="Apple-converted-space">                                </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span>{m.sources &amp;&amp; m.sources.length &gt; </span><span class="s7">0</span><span class="s2"> &amp;&amp; (</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">                                    </span>&lt;div className=</span><span class="s2">"mt-6 pt-4 border-t border-black/5 flex flex-col gap-3"</span><span class="s5">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                        </span>&lt;span className=</span><span class="s4">"text-[10px] uppercase tracking-[0.2em] font-black opacity-30"</span><span class="s2">&gt;</span><span class="s3">References</span><span class="s2">:&lt;/span&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                        </span>&lt;div className=</span><span class="s4">"grid grid-cols-1 gap-2"</span><span class="s2">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                            </span>{m.sources.map((s, si) =&gt; (</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                                </span>&lt;a<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                                    </span>key={si}<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                                    </span>href={s.uri}<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                                    </span>target=</span><span class="s4">"_blank"</span><span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                                    </span>rel=</span><span class="s4">"noopener noreferrer"</span><span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">                                                    </span>className=</span><span class="s2">"text-lg bg-white hover:bg-[#f9f9f9] text-[#AA336A] font-black px-4 py-3 rounded-xl transition-all shadow-sm border border-black/5 flex items-center justify-between active:scale-[0.98] group no-underline"</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                                </span>&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                                    </span>&lt;span className=</span><span class="s4">"truncate pr-4"</span><span class="s2">&gt;{s.title}&lt;/span&gt;</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">                                                    </span>&lt;svg xmlns=</span><span class="s2">"http://www.w3.org/2000/svg"</span><span class="s5"> className=</span><span class="s2">"h-5 w-5 flex-shrink-0 opacity-40 group-hover:opacity-100 transition-opacity"</span><span class="s5"> fill=</span><span class="s2">"none"</span><span class="s5"> viewBox=</span><span class="s2">"0 0 24 24"</span><span class="s5"> stroke=</span><span class="s2">"currentColor"</span><span class="s5">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                                        </span>&lt;path strokeLinecap=</span><span class="s4">"round"</span><span class="s2"> strokeLinejoin=</span><span class="s4">"round"</span><span class="s2"> strokeWidth={</span><span class="s7">3</span><span class="s2">} d=</span><span class="s4">"M14 5l7 7m0 0l-7 7m7-7H3"</span><span class="s2"> /&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                                    </span>&lt;/svg&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                                </span>&lt;/a&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                            </span>))}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span>)}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span>))}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span>{isTyping &amp;&amp; (</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span>&lt;div className=</span><span class="s4">"flex justify-start"</span><span class="s2">&gt;</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">                            </span>&lt;div className=</span><span class="s2">"bg-white/40 px-4 py-2 rounded-2xl text-sm italic opacity-50 animate-pulse"</span><span class="s5">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                                </span>{t.expert.typing}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span>)}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span>&lt;div ref={messagesEndRef} /&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">                </span>&lt;form onSubmit={handleSendMessage} className=</span><span class="s2">"mt-4 pt-4 border-t border-black/10 flex items-center gap-2 shrink-0"</span><span class="s5">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span>&lt;input<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s1">type</span><span class="s2">=</span><span class="s4">"text"</span><span class="s2"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span>value={inputValue}<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span>onChange={e =&gt; setInputValue(e.target.value)}<span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span>placeholder={t.expert.placeholder}<span class="Apple-converted-space"> </span></span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">                        </span>className=</span><span class="s2">"flex-grow min-w-0 bg-white/50 border border-white/60 rounded-2xl px-5 py-4 outline-none focus:ring-2 focus:ring-[#AA336A] text-lg font-medium shadow-inner"</span><span class="s5"><span class="Apple-converted-space"> </span></span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span>/&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span>&lt;</span><span class="s3">Button</span><span class="s2"> </span><span class="s1">type</span><span class="s2">=</span><span class="s4">"submit"</span><span class="s2"> disabled={!inputValue.trim() || isTyping} className=</span><span class="s4">"!w-auto !py-4 !px-8 shadow-lg uppercase tracking-wider"</span><span class="s2">&gt;{t.expert.btn_send}&lt;/</span><span class="s3">Button</span><span class="s2">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span>&lt;/form&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>&lt;/</span><span class="s3">Card</span><span class="s2">&gt;</span></p>
<p class="p5"><span class="s6"></span><br></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>&lt;</span><span class="s3">Modal</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span>isOpen={quotaModal.isOpen}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span>onClose={() =&gt; setQuotaModal({ ...quotaModal, isOpen: </span><span class="s1">false</span><span class="s2"> })}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span>title={quotaModal.title}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span>confirmText={t.quota.btn_dismiss}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span>onConfirm={() =&gt; setQuotaModal({ ...quotaModal, isOpen: </span><span class="s1">false</span><span class="s2"> })}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>&gt;</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">                </span>&lt;div className=</span><span class="s2">"flex flex-col items-center text-center py-4"</span><span class="s5">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span>&lt;</span><span class="s3">PetCharacter</span><span class="s2"> pet=</span><span class="s4">"dog"</span><span class="s2"> className=</span><span class="s4">"w-32 h-32 mb-6"</span><span class="s2"> /&gt;</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">                    </span>&lt;p className=</span><span class="s2">"text-lg leading-relaxed font-medium"</span><span class="s5">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                        </span>{quotaModal.desc}</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                    </span>&lt;/p&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">                </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">            </span>&lt;/</span><span class="s3">Modal</span><span class="s2">&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">        </span>&lt;/&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>);</span></p>
<p class="p1"><span class="s2">};</span></p>
<p class="p5"><span class="s6"></span><br></p>
<p class="p3"><span class="s1">interface</span><span class="s5"> </span><span class="s2">PlayScreenProps</span><span class="s5"> {</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span>onQuizComplete: (result: </span><span class="s3">PetPersonalityResult</span><span class="s2">) =&gt; </span><span class="s1">void</span><span class="s2">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span>savedNames: </span><span class="s3">GeneratedName</span><span class="s2">[];</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span>addSavedName: (name: </span><span class="s3">GeneratedName</span><span class="s2">) =&gt; </span><span class="s1">void</span><span class="s2">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span>petInfo: </span><span class="s3">PetInfo</span><span class="s2">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span>setPetInfo: (info: </span><span class="s3">PetInfo</span><span class="s2"> | ((prev: </span><span class="s3">PetInfo</span><span class="s2">) =&gt; </span><span class="s3">PetInfo</span><span class="s2">)) =&gt; </span><span class="s1">void</span><span class="s2">;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span>goHome: () =&gt; </span><span class="s1">void</span><span class="s2">;</span></p>
<p class="p1"><span class="s2">}</span></p>
<p class="p5"><span class="s6"></span><br></p>
<p class="p2"><span class="s1">type</span><span class="s5"> </span><span class="s3">PlayMode</span><span class="s5"> = </span><span class="s2">'menu'</span><span class="s5"> | </span><span class="s2">'quiz'</span><span class="s5"> | </span><span class="s2">'battle'</span><span class="s5"> | </span><span class="s2">'translator'</span><span class="s5"> | </span><span class="s2">'horoscope'</span><span class="s5"> | </span><span class="s2">'calculator'</span><span class="s5"> | </span><span class="s2">'expert'</span><span class="s5">;</span></p>
<p class="p5"><span class="s6"></span><br></p>
<p class="p1"><span class="s1">export</span><span class="s2"> </span><span class="s1">const</span><span class="s2"> </span><span class="s3">PlayScreen</span><span class="s2">: </span><span class="s3">React</span><span class="s2">.</span><span class="s3">FC</span><span class="s2">&lt;</span><span class="s3">PlayScreenProps</span><span class="s2">&gt; = ({ onQuizComplete, savedNames, addSavedName, petInfo, setPetInfo, goHome }) =&gt; {</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> { t } = useLanguage();</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">const</span><span class="s2"> [mode, setMode] = useState&lt;</span><span class="s3">PlayMode</span><span class="s2">&gt;(</span><span class="s4">'menu'</span><span class="s2">);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span></span><span class="s1">if</span><span class="s2"> (mode === </span><span class="s4">'menu'</span><span class="s2">) {</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">const</span><span class="s2"> menuItems: { id: </span><span class="s3">PlayMode</span><span class="s2">, title: </span><span class="s1">string</span><span class="s2">, desc: </span><span class="s1">string</span><span class="s2">, pet: </span><span class="s3">PetKind</span><span class="s2"> }[] = [ { id: </span><span class="s4">'quiz'</span><span class="s2">, title: t.quiz.title, desc: t.quiz.subtitle, pet: </span><span class="s4">'hamster'</span><span class="s2"> }, { id: </span><span class="s4">'battle'</span><span class="s2">, title: t.quick_fire.title, desc: t.quick_fire.subtitle, pet: </span><span class="s4">'cat'</span><span class="s2"> }, { id: </span><span class="s4">'expert'</span><span class="s2">, title: t.expert.title, desc: t.expert.subtitle, pet: </span><span class="s4">'dog'</span><span class="s2"> }, { id: </span><span class="s4">'translator'</span><span class="s2">, title: t.translator.title, desc: t.translator.subtitle, pet: </span><span class="s4">'bird'</span><span class="s2"> }, { id: </span><span class="s4">'horoscope'</span><span class="s2">, title: t.horoscope.title, desc: t.horoscope.subtitle, pet: </span><span class="s4">'lizard'</span><span class="s2"> }, { id: </span><span class="s4">'calculator'</span><span class="s2">, title: t.age_calc.title, desc: t.age_calc.subtitle, pet: </span><span class="s4">'rabbit'</span><span class="s2"> }, ];</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">return</span><span class="s2"> (</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">      </span>&lt;div className=</span><span class="s2">"relative min-h-screen"</span><span class="s5">&gt;&lt;</span><span class="s3">Header</span><span class="s5"> leftPet=</span><span class="s2">"hamster"</span><span class="s5"> rightPet=</span><span class="s2">"bird"</span><span class="s5"> onLogoClick={goHome} /&gt;&lt;main className=</span><span class="s2">"px-4 pb-32 max-w-4xl mx-auto w-full flex flex-col gap-6 animate-fade-in mt-2"</span><span class="s5">&gt;&lt;div className=</span><span class="s2">"-mt-4"</span><span class="s5">&gt;&lt;</span><span class="s3">BackToHomeButton</span><span class="s5"> onClick={goHome} /&gt;&lt;/div&gt;&lt;div className=</span><span class="s2">"grid grid-cols-1 sm:grid-cols-2 gap-6"</span><span class="s5">&gt;{menuItems.map(item =&gt; &lt;button key={item.id} onClick={() =&gt; setMode(item.id)} className=</span><span class="s2">"bg-[var(--card-bg)] backdrop-blur-md rounded-[2rem] p-6 shadow-md border-2 border-white/40 flex flex-col items-center text-center gap-3 transition-all hover:scale-[1.02] hover:shadow-xl active:scale-95 group"</span><span class="s5">&gt;&lt;</span><span class="s3">PetCharacter</span><span class="s5"> pet={item.pet} className=</span><span class="s2">"w-24 h-24 mb-2 transform group-hover:-translate-y-1 transition-transform"</span><span class="s5"> /&gt;&lt;h3 className=</span><span class="s2">"text-2xl font-black text-[var(--text-main)] group-hover:text-[#AA336A]"</span><span class="s5">&gt;{item.title}&lt;/h3&gt;&lt;p className=</span><span class="s2">"text-sm font-bold opacity-80 line-clamp-2"</span><span class="s5">&gt;{item.desc}&lt;/p&gt;&lt;/button&gt;)}&lt;/div&gt;&lt;/main&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">    </span>);</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span>}</span></p>
<p class="p4"><span class="s5"><span class="Apple-converted-space">  </span></span><span class="s2">return</span><span class="s5"> (</span></p>
<p class="p6"><span class="s6"><span class="Apple-converted-space">    </span>&lt;div className=</span><span class="s9">"relative min-h-screen"</span><span class="s6">&gt;&lt;</span><span class="s8">Header</span><span class="s6"> leftPet=</span><span class="s9">"hamster"</span><span class="s6"> rightPet=</span><span class="s9">"bird"</span><span class="s6"> onLogoClick={() =&gt; setMode(</span><span class="s9">'menu'</span><span class="s6">)} /&gt;&lt;main className=</span><span class="s9">"px-4 pb-32 max-w-xl mx-auto w-full animate-fade-in mt-4"</span><span class="s6">&gt;&lt;div className=</span><span class="s9">"-mt-4 flex gap-3 mb-6"</span><span class="s6">&gt;&lt;button onClick={() =&gt; setMode(</span><span class="s9">'menu'</span><span class="s6">)} className=</span><span class="s9">"flex items-center gap-2 text-white hover:scale-105 transition-all bg-white/20 px-4 py-2 rounded-full backdrop-blur-md font-bold text-sm w-fit shadow-sm hover:bg-white/30 active:scale-95"</span><span class="s6">&gt;&lt;</span><span class="s8">BackIcon</span><span class="s6"> className=</span><span class="s9">"w-4 h-4"</span><span class="s6"> /&gt;{t.common.menu_label}&lt;/button&gt;&lt;</span><span class="s8">BackToHomeButton</span><span class="s6"> onClick={goHome} /&gt;&lt;/div&gt;{mode === </span><span class="s9">'quiz'</span><span class="s6"> &amp;&amp; &lt;</span><span class="s8">PersonalityQuiz</span><span class="s6"> onQuizComplete={onQuizComplete} petInfo={petInfo} setPetInfo={setPetInfo} addSavedName={addSavedName} savedNames={savedNames} /&gt;}{mode === </span><span class="s9">'battle'</span><span class="s6"> &amp;&amp; &lt;</span><span class="s8">QuickFireDiscovery</span><span class="s6"> addSavedName={addSavedName} savedNames={savedNames} petInfo={petInfo} setPetInfo={setPetInfo} /&gt;}{mode === </span><span class="s9">'translator'</span><span class="s6"> &amp;&amp; &lt;</span><span class="s8">NameTranslator</span><span class="s6"> /&gt;}{mode === </span><span class="s9">'horoscope'</span><span class="s6"> &amp;&amp; &lt;</span><span class="s8">PetHoroscope</span><span class="s6"> /&gt;}{mode === </span><span class="s9">'calculator'</span><span class="s6"> &amp;&amp; &lt;</span><span class="s8">PetAgeCalculator</span><span class="s6"> /&gt;}{mode === </span><span class="s9">'expert'</span><span class="s6"> &amp;&amp; &lt;</span><span class="s8">Consultant</span><span class="s6"> /&gt;}&lt;/main&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s2"><span class="Apple-converted-space">  </span>);</span></p>
<p class="p1"><span class="s2">};</span></p>
</body>
</html>
